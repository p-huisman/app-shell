var S=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,n)=>(typeof require!="undefined"?require:t)[n]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});import i from"react";import N from"react-dom";function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,o)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R(Object(n),!0).forEach(function(o){D(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function C(e){return(C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){return(h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function E(e,t){var n;if(typeof(n=t.domElement?function(){return t.domElement}:t.domElementGetter?t.domElementGetter:e.domElementGetter?e.domElementGetter:function(o){var a=o.appName||o.name;if(!a)throw Error("single-spa's dom-element-getter-helpers was not given an application name as a prop, so it can't make a unique dom element container for the react application");var r="single-spa-application:".concat(a);return function(){var s=document.getElementById(r);return s||((s=document.createElement("div")).id=r,document.body.appendChild(s)),s}}(t))!="function")throw Error("single-spa's dom-element-getter-helpers was given an invalid domElementGetter for application or parcel '".concat(t.name,"'. Expected a function, received ").concat(h(n)));return function(){var o=n(t);if(!(o instanceof HTMLElement))throw Error("single-spa's dom-element-getter-helpers: domElementGetter returned an invalid dom element for application or parcel '".concat(t.name,"'. Expected HTMLElement, received ").concat(h(o)));return o}}var p=null;try{p=S("react").createContext()}catch(e){}var B={React:null,ReactDOM:null,ReactDOMClient:null,rootComponent:null,loadRootComponent:null,errorBoundary:null,errorBoundaryClass:null,domElementGetter:null,parcelCanUpdate:!0,suppressComponentDidCatchWarning:!1,domElements:{},renderResults:{},updateResolves:{},unmountResolves:{}};function O(e){if(C(e)!=="object")throw new Error("single-spa-react requires a configuration object");var t,n=d(d({},B),e);if(!n.React)throw new Error("single-spa-react must be passed opts.React");if(!n.ReactDOM&&!n.ReactDOMClient)throw new Error("single-spa-react must be passed opts.ReactDOM or opts.ReactDOMClient");if(n.renderType||((t=n.ReactDOMClient)!==null&&t!==void 0&&t.createRoot?n.renderType="createRoot":n.renderType="render"),!n.rootComponent&&!n.loadRootComponent)throw new Error("single-spa-react must be passed opts.rootComponent or opts.loadRootComponent");if(n.errorBoundary&&typeof n.errorBoundary!="function")throw Error("The errorBoundary opt for single-spa-react must either be omitted or be a function that returns React elements");!p&&n.React.createContext&&(p=n.React.createContext()),n.SingleSpaRoot=function(a){function r(s){r.displayName="SingleSpaRoot(".concat(s.name,")")}return r.prototype=Object.create(a.React.Component.prototype),r.prototype.componentDidMount=function(){setTimeout(this.props.mountFinished)},r.prototype.componentWillUnmount=function(){setTimeout(this.props.unmountFinished)},r.prototype.render=function(){return setTimeout(this.props.updateFinished),this.props.children},r}(n);var o={bootstrap:M.bind(null,n),mount:T.bind(null,n),unmount:j.bind(null,n)};return n.parcelCanUpdate&&(o.update=P.bind(null,n)),o}function M(e,t){return e.rootComponent?Promise.resolve():e.loadRootComponent(t).then(function(n){e.rootComponent=n})}function T(e,t){return new Promise(function(n,o){e.suppressComponentDidCatchWarning||!function(u){if(!(u&&typeof u.version=="string"&&u.version.indexOf(".")>=0))return!1;var c=u.version.slice(0,u.version.indexOf("."));try{return Number(c)>=16}catch(l){return!1}}(e.React)||e.errorBoundary||e.errorBoundaryClass||(e.rootComponent.prototype?e.rootComponent.prototype.componentDidCatch||console.warn("single-spa-react: ".concat(t.name||t.appName||t.childAppName,"'s rootComponent should implement componentDidCatch to avoid accidentally unmounting the entire single-spa application.")):console.warn("single-spa-react: ".concat(t.name||t.appName||t.childAppName,"'s rootComponent does not implement an error boundary.  If using a functional component, consider providing an opts.errorBoundary to singleSpaReact(opts).")));var a=w(e,t,function(){n(this)}),r=E(e,t)(),s=function(u){var c=u.reactDom,l=u.renderType,f=u.elementToRender,y=u.domElement,m=c[l];if(typeof m!="function")throw new Error('renderType "'.concat(l,'" did not return a function.'));switch(l){case"createRoot":case"unstable_createRoot":case"createBlockingRoot":case"unstable_createBlockingRoot":var v=m(y);return v.render(f),v;case"hydrateRoot":return m(y,f);case"hydrate":default:return m(f,y),null}}({elementToRender:a,domElement:r,reactDom:b(e),renderType:x(e)});e.domElements[t.name]=r,e.renderResults[t.name]=s})}function j(e,t){return new Promise(function(n){e.unmountResolves[t.name]=n;var o=e.renderResults[t.name];o&&o.unmount?o.unmount():b(e).unmountComponentAtNode(e.domElements[t.name]),delete e.domElements[t.name],delete e.renderResults[t.name]})}function P(e,t){return new Promise(function(n){e.updateResolves[t.name]||(e.updateResolves[t.name]=[]),e.updateResolves[t.name].push(n);var o=w(e,t,null),a=e.renderResults[t.name];if(a&&a.render)a.render(o);else{var r=E(e,t)();b(e).render(o,r)}})}function b(e){return e.ReactDOMClient||e.ReactDOM}function x(e){return typeof e.renderType=="function"?e.renderType():e.renderType}function w(e,t,n){var o=e.React.createElement(e.rootComponent,t),a=p?e.React.createElement(p.Provider,{value:t},o):o;return(e.errorBoundary||t.errorBoundary||e.errorBoundaryClass||t.errorBoundaryClass)&&(e.errorBoundaryClass=e.errorBoundaryClass||t.errorBoundaryClass||function(r,s){function u(c){r.React.Component.apply(this,arguments),this.state={caughtError:null,caughtErrorInfo:null},u.displayName="SingleSpaReactErrorBoundary(".concat(c.name,")")}return u.prototype=Object.create(r.React.Component.prototype),u.prototype.render=function(){return this.state.caughtError?(r.errorBoundary||s.errorBoundary)(this.state.caughtError,this.state.caughtErrorInfo,this.props):this.props.children},u.prototype.componentDidCatch=function(c,l){this.setState({caughtError:c,caughtErrorInfo:l})},u}(e,t),a=e.React.createElement(e.errorBoundaryClass,t,a)),a=e.React.createElement(e.SingleSpaRoot,d(d({},t),{},{mountFinished:n,updateFinished:function(){e.updateResolves[t.name]&&(e.updateResolves[t.name].forEach(function(r){return r()}),delete e.updateResolves[t.name])},unmountFinished:function(){e.unmountResolves[t.name]&&(e.unmountResolves[t.name](),delete e.unmountResolves[t.name])}}),a)}var k=e=>{let{appShellState:t}=e;return i.createElement("div",{id:"dashboard"},"App ",new Date().toLocaleTimeString(),i.createElement("p",null,i.createElement("button",{onClick:()=>t.addMessage("Hello","info")},"Add Message"),i.createElement("button",{onClick:()=>{let n=document.createElement("div");n.innerHTML="Hello",t.addMessage(n,"error")}},"Add Message"),i.createElement("button",{onClick:()=>{let n=()=>i.createElement("div",null,"Lala");n.innerHTML="Hello",t.addMessage(n,"success")}},"Add Message")))},g=O({React:i,ReactDOM:N,rootComponent:k,errorBoundary(e){return i.createElement("div",null,"Fatal error $",e.message," ")}}),I=g.bootstrap,q=g.mount,U=g.unmount;export{I as bootstrap,g as lifecycles,q as mount,U as unmount};
